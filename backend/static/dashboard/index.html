<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Horse Predictor â€“ ìš´ì˜ ëŒ€ì‹œë³´ë“œ</title>
</head>
<body>

<h1>ğŸ Horse Predictor â€“ ìš´ì˜ ëŒ€ì‹œë³´ë“œ</h1>

<hr/>

<h2>ì›”ê°„ KPI</h2>
Year <input id="kpiYear" value="2025">
Month <input id="kpiMonth" value="4">
<button onclick="loadKPI()">ì¡°íšŒ</button>
<div id="kpiResult"></div>

<hr/>

<h2>Confidence ë¶„í¬</h2>
Season <input id="confSeason" value="202504">
Race <input id="confRace" value="202504-02">
<button onclick="loadConfidence()">ì¡°íšŒ</button>
<pre id="confResult"></pre>

<hr/>

<h2>ì „ëµ ë¹„êµ (PASS ì œì™¸ + Threshold)</h2>
Season <input id="strSeason" value="202504">
Thresholds <input id="strTh" value="0.10,0.15,0.20,0.25">
<button onclick="loadStrategy()">ë¹„êµ</button>
<pre id="strResult"></pre>

<hr/>

<h2>ì›”Â·ë¶„ê¸° PDF ë¦¬í¬íŠ¸</h2>
Year <input id="pdfYear" value="2025">
Month <input id="pdfMonth" value="4">
<button onclick="makeMonthPDF()">ì›”ê°„ PDF</button>

<br/><br/>

Year <input id="pdfYearQ" value="2025">
Quarter <input id="pdfQuarter" value="2">
<button onclick="makeQuarterPDF()">ë¶„ê¸° PDF</button>

<script>
async function loadKPI() {
  const y = kpiYear.value;
  const m = kpiMonth.value;
  const r = await fetch(`/api/metrics/month?year=${y}&month=${m}`);
  const d = await r.json();
  kpiResult.innerHTML =
    `HIT:${d.hits} / MISS:${d.misses} / PASS:${d.passes} / ì ì¤‘ë¥ :${(d.accuracy*100).toFixed(2)}%`;
}

async function loadConfidence() {
  const s = confSeason.value;
  const r = confRace.value;
  const res = await fetch(`/api/metrics/confidence?season=${s}&race=${r}`);
  confResult.textContent = JSON.stringify(await res.json(), null, 2);
}

async function loadStrategy() {
  const s = strSeason.value;
  const t = strTh.value;
  const res = await fetch(`/api/metrics/strategy?season=${s}&thresholds=${t}`);
  strResult.textContent = JSON.stringify(await res.json(), null, 2);
}

async function makeMonthPDF() {
  const y = pdfYear.value;
  const m = pdfMonth.value;
  const res = await fetch(`/api/report/monthly?year=${y}&month=${m}`, {method:"POST"});
  const d = await res.json();
  window.open(d.url);
}

async function makeQuarterPDF() {
  const y = pdfYearQ.value;
  const q = pdfQuarter.value;
  const res = await fetch(`/api/report/quarter?year=${y}&quarter=${q}`, {method:"POST"});
  const d = await res.json();
  window.open(d.url);
}
</script>

</body>
</html>
